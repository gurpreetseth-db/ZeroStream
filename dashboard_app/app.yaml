# =============================================================================
# Databricks Apps configuration for ZeroStream Dashboard
# AUTO-GENERATED by infra/generate_app_yaml.py - DO NOT EDIT MANUALLY
# =============================================================================
command:
  - "uvicorn"
  - "app:app"
  - "--host"
  - "0.0.0.0"
  - "--port"
  - "8000"
  - "--workers"
  - "1"
  - "--log-level"
  - "info"

env:
  - name: "CATALOG"
    value: "gsethi"
  - name: "SCHEMA"
    value: "zerobusstream"
  - name: "TABLE_NAME"
    value: "sensor_stream"
  - name: "ZEROBUS_SERVER_ENDPOINT"
    value: "7474644305162519.zerobus.ap-southeast-2.cloud.databricks.com"
  - name: "ZEROBUS_CLIENT_ID"
    value: "b01bc5c9-1002-4629-9b09-c0c494fb77dc"
  - name: "ZEROBUS_TOPIC"
    value: "gsethi_sensor_stream_topic"
  - name: "DATABRICKS_HOST"
    value: "https://dbc-d79edc97-4379.cloud.databricks.com/"
  - name: "DATABRICKS_WAREHOUSE_ID"
    value: "82a911a69a8ba369"
  - name: "LAKEBASE_HOST"
    value: "instance-62a191f8-840b-46c9-9be7-e8f21345c3c0.database.cloud.databricks.com"
  - name: "LAKEBASE_PORT"
    value: "5432"
  - name: "LAKEBASE_DATABASES"
    value: "zerobusstream"
  - name: "LAKEBASE_SCHEMA"
    value: "zerobusstream"
  - name: "LAKEBASE_CATALOG"
    value: "gsethi_lakebase"
  - name: "STREAM_INTERVAL_MS"
    value: "5000"
  - name: "ACTIVE_WINDOW_SECONDS"
    value: "5"
  - name: "DASHBOARD_APP"
    value: "gsethi-dashboard-app"

# ============================================================================
# SECRETS: Configure these in Databricks Apps UI
# ============================================================================
# Apps > [app-name] > Settings > Environment Variables
# - ZEROBUS_CLIENT_SECRET (if using ZeroBus OAuth)
#
# For Lakebase access, add as app resource instead:
# Apps > [app-name] > Settings > Resources > Add Lakebase database
# This auto-injects: PGHOST, PGDATABASE, PGUSER, PGPASSWORD, PGPORT
# ============================================================================
